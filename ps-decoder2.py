import re
#Decoder for observed malware https://www.hybrid-analysis.com/sample/f22ae5b76efab9e16b1077818431501a0b01963316a883c2d39ba627353e0781?environmentId=100
#The example here is for decoding a CTF I wrote in 2019
#Replace utlindex and urlindex2 variable with your sample strings
urlindex='''aKCCwqhCJrGjT}C7WfZ/N30@yeLlDFQbXPv-IViB14g{Opo=8HsM,k;dS' Rt:\(9mY6cnuE$A5x.'''
urlindex2="%rjioubmatp:~66,1%%rjioubmatp:~46,1%%rjioubmatp:~70,1%%rjioubmatp:~58,1%%rjioubmatp:~6,1%%rjioubmatp:~0,1%%rjioubmatp:~34,1%%rjioubmatp:~25,1%%rjioubmatp:~58,1%%rjioubmatp:~55,1%%rjioubmatp:~46,1%%rjioubmatp:~69,1%%rjioubmatp:~25,1%%rjioubmatp:~58,1%%rjioubmatp:~4,1%%rjioubmatp:~25,1%%rjioubmatp:~27,1%%rjioubmatp:~27,1%%rjioubmatp:~58,1%%rjioubmatp:~60,1%%rjioubmatp:~46,1%%rjioubmatp:~58,1%%rjioubmatp:~55,1%%rjioubmatp:~25,1%%rjioubmatp:~68,1%%rjioubmatp:~46,1%%rjioubmatp:~55,1%%rjioubmatp:~25,1%%rjioubmatp:~58,1%%rjioubmatp:~65,1%%rjioubmatp:~25,1%%rjioubmatp:~52,1%%rjioubmatp:~58,1%%rjioubmatp:~0,1%%rjioubmatp:~50,1%%rjioubmatp:~58,1%%rjioubmatp:~0,1%%rjioubmatp:~58,1%%rjioubmatp:~9,1%%rjioubmatp:~25,1%%rjioubmatp:~16,1%%rjioubmatp:~0,1%%rjioubmatp:~9,1%%rjioubmatp:~55,1%%rjioubmatp:~58,1%%rjioubmatp:~17,1%%rjioubmatp:~46,1%%rjioubmatp:~9,1%%rjioubmatp:~58,1%%rjioubmatp:~24,1%%rjioubmatp:~46,1%%rjioubmatp:~70,1%%rjioubmatp:~9,1%%rjioubmatp:~58,1%%rjioubmatp:~25,1%%rjioubmatp:~75,1%%rjioubmatp:~60,1%%rjioubmatp:~9,1%%rjioubmatp:~0,1%%rjioubmatp:~46,1%%rjioubmatp:~9,1%%rjioubmatp:~55,1%%rjioubmatp:~38,1%%rjioubmatp:~69,1%%rjioubmatp:~0,1%%rjioubmatp:~9,1%%rjioubmatp:~24,1%%rjioubmatp:~58,1%%rjioubmatp:~25,1%%rjioubmatp:~17,1%%rjioubmatp:~17,1%%rjioubmatp:~46,1%%rjioubmatp:~9,1%%rjioubmatp:~60,1%%rjioubmatp:~50,1%%rjioubmatp:~52,1%%rjioubmatp:~58,1%%rjioubmatp:~4,1%%rjioubmatp:~25,1%%rjioubmatp:~58,1%%rjioubmatp:~50,1%%rjioubmatp:~6,1%%rjioubmatp:~0,1%%rjioubmatp:~27,1%%rjioubmatp:~27,1%%rjioubmatp:~58,1%%rjioubmatp:~42,1%%rjioubmatp:~38,1%%rjioubmatp:~34,1%%rjioubmatp:~25,1%%rjioubmatp:~58,1%%rjioubmatp:~60,1%%rjioubmatp:~6,1%%rjioubmatp:~38,1%%rjioubmatp:~50,1%%rjioubmatp:~58,1%%rjioubmatp:~65,1%%rjioubmatp:~46,1%%rjioubmatp:~50,1%%rjioubmatp:~60,1%%rjioubmatp:~58,1%%rjioubmatp:~25,1%%rjioubmatp:~75,1%%rjioubmatp:~68,1%%rjioubmatp:~25,1%%rjioubmatp:~27,1%%rjioubmatp:~27,1%%rjioubmatp:~25,1%%rjioubmatp:~69,1%%rjioubmatp:~60,1%%rjioubmatp:~58,1%%rjioubmatp:~60,1%%rjioubmatp:~25,1%%rjioubmatp:~75,1%%rjioubmatp:~60,1%%rjioubmatp:~58,1%%rjioubmatp:~60,1%%rjioubmatp:~46,1%%rjioubmatp:~58,1%%rjioubmatp:~68,1%%rjioubmatp:~46,1%%rjioubmatp:~69,1%%rjioubmatp:~50,1%%rjioubmatp:~38,1%%rjioubmatp:~55,1%%rjioubmatp:~25,1%%rjioubmatp:~9,1%%rjioubmatp:~61,1%%rjioubmatp:~58,1%%rjioubmatp:~17,1%%rjioubmatp:~27,1%%rjioubmatp:~0,1%%rjioubmatp:~42,1%%rjioubmatp:~47,1%%rjioubmatp:~43,1%%rjioubmatp:~71,1%%rjioubmatp:~65,1%%rjioubmatp:~46,1%%rjioubmatp:~60,1%%rjioubmatp:~25,1%%rjioubmatp:~60,1%%rjioubmatp:~35,1%%rjioubmatp:~36,1%%rjioubmatp:~69,1%%rjioubmatp:~50,1%%rjioubmatp:~45,1%%rjioubmatp:~38,1%%rjioubmatp:~9,1%%rjioubmatp:~25,1%%rjioubmatp:~55,1%%rjioubmatp:~35,1%%rjioubmatp:~28,1%%rjioubmatp:~44,1%%rjioubmatp:~56,1%%rjioubmatp:~17,1%%rjioubmatp:~70,1%%rjioubmatp:~50,1%%rjioubmatp:~68,1%%rjioubmatp:~0,1%%rjioubmatp:~60,1%%rjioubmatp:~38,1%%rjioubmatp:~46,1%%rjioubmatp:~69,1%%rjioubmatp:~13,1%"
urlindex2 = re.sub('[%:a-zA-Z~]', ' ', urlindex2) #remove variablename
urlindex2 = re.sub(',1','',urlindex2)
urlindex2 = urlindex2.split() #split the list
templist=list()

for p in urlindex2:
	t = ''.join(urlindex[int(p)])
	templist.append(t)
		
print ''.join(templist).strip()
